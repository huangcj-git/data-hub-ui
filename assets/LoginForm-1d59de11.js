import{F as e}from"./Form-cb4d378d.js";import{b as o,d as s}from"./useI18n-58b225c6.js";import{E as t}from"./el-button-b3603e9b.js";import{E as r}from"./tsxHelper-4d453bcf.js";import{E as a}from"./el-link-3d4cba53.js";import{u as i}from"./useForm-5e5b70fc.js";import{l,g as n,a as p}from"./index-0ad5c79c.js";import{a as m}from"./app-9f5217c9.js";import{a as c}from"./permission-9d80cb01.js";import{u as d}from"./vue-router-bb140294.js";import{u}from"./useValidator-d1d62da1.js";import{g as j,a as g,r as f,j as w,s as h,l as v,m as b,w as _,y,b5 as x,u as R,c as P,ag as I}from"./runtime-core.esm-bundler-9826e6ce.js";import{_ as k}from"./_plugin-vue_export-helper-1b428a4d.js";import"./el-col-4c80b79a.js";import"./typescript-5028724d.js";import"./el-popper-ac7429d6.js";import"./useDesign-153c2279.js";import"./index-052519ae.js";import"./el-input-51a54408.js";import"./index-613eaa2d.js";import"./style-cacd911c.js";import"./event-5568c9d8.js";import"./index-a18f7570.js";import"./error-c58402b8.js";import"./el-tag-78fc1d62.js";import"./el-scrollbar-2642ea66.js";import"./el-input-number-eccd303e.js";import"./index-d58b826b.js";import"./el-switch-b25caa3d.js";import"./validator-787b8554.js";import"./el-divider-53cf84d5.js";import"./InputPassword-e5f2e2d5.js";import"./style.css_vue_type_style_index_0_src_true_lang-56c03272.js";import"./is-c4ce1157.js";import"./el-message-a1f84c0e.js";import"./debounce-1d93e3d0.js";import"./aria-ecee1d93.js";import"./scroll-42c4a477.js";import"./_flatRest-0ed13584.js";import"./_initCloneObject-940b5095.js";import"./cloneDeep-7e4a742d.js";import"./isArrayLikeObject-a2703072.js";import"./_arrayIncludesWith-032ec3dd.js";import"./browser-22c4830b.js";import"./index-faf5036a.js";import"./Icon.vue_vue_type_script_setup_true_lang-984f254e.js";import"./index-ee9e4366.js";import"./isPlainObject-1982923d.js";const z={class:"text-2xl font-bold text-center w-[100%]"},D={class:"flex justify-between items-center w-[100%]"},F={class:"w-[100%]"},A={class:"w-[100%] mt-15px"},C={class:"flex justify-between w-[100%]"},E=k(j({__name:"LoginForm",emits:["to-register"],setup(j,{emit:k}){const{required:E}=u(),q=m(),V=c(),{currentRoute:L,addRoute:O,push:U}=d(),{wsCache:B}=o(),{t:H}=s(),N={username:[E()],password:[E()]},W=g([{field:"title",colProps:{span:24}},{field:"username",label:H("login.username"),value:"admin",component:"Input",colProps:{span:24},componentProps:{placeholder:H("login.usernamePlaceholder")}},{field:"password",label:H("login.password"),value:"admin",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:H("login.passwordPlaceholder")}},{field:"tool",colProps:{span:24}},{field:"login",colProps:{span:24}},{field:"other",component:"Divider",label:H("login.otherLogin"),componentProps:{contentPosition:"center"}},{field:"otherIcon",colProps:{span:24}}]),G=f(!1),{register:J,elFormRef:K,methods:M}=i(),Q=f(!1),S="#999",T=f("");w((()=>L.value),(e=>{var o;T.value=null==(o=null==e?void 0:e.query)?void 0:o.redirect}),{immediate:!0});const X=async()=>{const e=R(K);await(null==e?void 0:e.validate((async e=>{if(e){Q.value=!0;const{getFormData:e}=M,o=await e();try{const e=await l(o);e&&(B.set(q.getUserInfo,e.data),q.getDynamicRouter?Y():(await V.generateRoutes("none").catch((()=>{})),V.getAddRouters.forEach((e=>{O(e)})),V.setIsAddRouters(!0),U({path:T.value||V.addRouters[0].path})))}finally{Q.value=!1}}})))},Y=async()=>{const{getFormData:e}=M,s=await e(),t={roleName:s.username},r="admin"===s.username?await n(t):await p(t);if(r){const{wsCache:e}=o(),t=r.data||[];e.set("roleRouters",t),"admin"===s.username?await V.generateRoutes("admin",t).catch((()=>{})):await V.generateRoutes("test",t).catch((()=>{})),V.getAddRouters.forEach((e=>{O(e)})),V.setIsAddRouters(!0),U({path:T.value||V.addRouters[0].path})}},Z=()=>{k("to-register")};return(o,s)=>{const i=h("Icon");return v(),b(R(e),{schema:W,rules:N,"label-position":"top","hide-required-asterisk":"",size:"large",class:"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid",onRegister:R(J)},{title:_((()=>[y("h2",z,x(R(H)("login.login")),1)])),tool:_((()=>[y("div",D,[P(R(r),{modelValue:G.value,"onUpdate:modelValue":s[0]||(s[0]=e=>G.value=e),label:R(H)("login.remember"),size:"small"},null,8,["modelValue","label"]),P(R(a),{type:"primary",underline:!1},{default:_((()=>[I(x(R(H)("login.forgetPassword")),1)])),_:1})])])),login:_((()=>[y("div",F,[P(R(t),{loading:Q.value,type:"primary",class:"w-[100%]",onClick:X},{default:_((()=>[I(x(R(H)("login.login")),1)])),_:1},8,["loading"])]),y("div",A,[P(R(t),{class:"w-[100%]",onClick:Z},{default:_((()=>[I(x(R(H)("login.register")),1)])),_:1})])])),otherIcon:_((()=>[y("div",C,[P(i,{icon:"ant-design:github-filled",size:30,class:"cursor-pointer anticon",color:S}),P(i,{icon:"ant-design:wechat-filled",size:30,class:"cursor-pointer anticon",color:S}),P(i,{icon:"ant-design:alipay-circle-filled",size:30,color:S,class:"cursor-pointer anticon"}),P(i,{icon:"ant-design:weibo-circle-filled",size:30,color:S,class:"cursor-pointer anticon"})])])),_:1},8,["schema","onRegister"])}}}),[["__scopeId","data-v-9a50efc0"]]);export{E as default};
