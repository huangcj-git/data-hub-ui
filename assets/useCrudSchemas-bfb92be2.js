import{e,t as o,f as l}from"./tree-b59d36bb.js";import{f as n}from"./index-faf5036a.js";import{u as t}from"./dict-cb8e8a52.js";import{d as s}from"./useI18n-58b225c6.js";import{a}from"./runtime-core.esm-bundler-9826e6ce.js";const i=t(),{t:c}=s(),r=e=>{const o=a({searchSchema:[],tableColumns:[],formSchema:[],detailSchema:[]}),l=d(e,o);o.searchSchema=l||[];const n=m(e);o.tableColumns=n||[];const t=p(e,o);o.formSchema=t;const s=f(e);return o.detailSchema=s,{allSchemas:o}},d=(o,l)=>{const t=[],s=[];e(o,(e=>{var o,a;if(null==(o=null==e?void 0:e.search)?void 0:o.show){const o={component:e.search.component||"Input",componentProps:{},...e.search,field:e.field,label:(null==(a=e.search)?void 0:a.label)||e.label};if(o.dictName){const e=i.getDictObj[o.dictName];o.componentProps.options=u(e)}else o.api&&s.push((async()=>{var e;const t=await o.api();if(t){const s=n(l.searchSchema,(e=>e.field===o.field));-1!==s&&(l.searchSchema[s].componentProps.options=u(t,null==(e=o.componentProps.optionsAlias)?void 0:e.labelField))}}));delete o.show,delete o.dictName,t.push(o)}}));for(const e of s)e();return t},m=e=>{const n=o(e,{conversion:e=>{var o;if(!1!==(null==(o=null==e?void 0:e.table)?void 0:o.show))return{...e.table,...e}}});return l(n,(e=>(void 0===e.children&&delete e.children,!!e.field)))},p=(o,l)=>{const t=[],s=[];e(o,(e=>{var o,a,c;if(!1!==(null==(o=null==e?void 0:e.form)?void 0:o.show)){const o={component:(null==(a=null==e?void 0:e.form)?void 0:a.component)||"Input",componentProps:{},...e.form,field:e.field,label:(null==(c=e.search)?void 0:c.label)||e.label};if(o.dictName){const e=i.getDictObj[o.dictName];o.componentProps.options=u(e)}else o.api&&s.push((async()=>{var e;const t=await o.api();if(t){const s=n(l.formSchema,(e=>e.field===o.field));-1!==s&&(l.formSchema[s].componentProps.options=u(t,null==(e=o.componentProps.optionsAlias)?void 0:e.labelField))}}));delete o.show,delete o.dictName,t.push(o)}}));for(const e of s)e();return t},f=o=>{const l=[];return e(o,(e=>{var o,n;if(!1!==(null==(o=null==e?void 0:e.detail)?void 0:o.show)){const o={...e.detail,field:e.field,label:(null==(n=e.detail)?void 0:n.label)||e.label};delete o.show,l.push(o)}})),l},u=(e,o)=>e.map((e=>(o?e.labelField=c(e.labelField):e.label=c(e.label),e)));export{r as u};
