import{al as e,d as a}from"./useI18n-d79c1d65.js";import{E as t}from"./el-message-box-fba4cfdf.js";import"./el-button-1bdd997e.js";import"./el-input-76b99827.js";import"./el-overlay-b2f833bb.js";import{E as n}from"./el-message-9459597d.js";import{a as s,k as o,j as r,r as i,u as l,n as c}from"./runtime-core.esm-bundler-9826e6ce.js";const{t:u}=a(),g=a=>{const g=s({pageSize:10,currentPage:1,total:10,tableList:[],params:{...(null==a?void 0:a.defaultParams)||{}},loading:!0,currentRow:null}),m=o((()=>({...g.params,pageSize:g.pageSize,pageIndex:g.currentPage})));r((()=>g.currentPage),(()=>{f.getList()})),r((()=>g.pageSize),(()=>{1===g.currentPage||(g.currentPage=1),f.getList()}));const p=i(),d=i(),v=async()=>{await c();const e=l(p);return e},P=async e=>{if(await((null==a?void 0:a.delListApi)&&(null==a?void 0:a.delListApi(e)))){n.success(u("common.delSuccess"));const a=(g.total%g.pageSize===e.length||1===g.pageSize)&&g.currentPage>1?g.currentPage-1:g.currentPage;g.currentPage=a,f.getList()}},f={getList:async()=>{var t;g.loading=!0;const n=await(null==a?void 0:a.getListApi(l(m)).finally((()=>{g.loading=!1})));n&&(g.tableList=e(n.data||{},null==a?void 0:a.response.list),g.total=e(n.data||{},null==(t=null==a?void 0:a.response)?void 0:t.total)||0)},setProps:async(e={})=>{const a=await v();null==a||a.setProps(e)},setColumn:async e=>{const a=await v();null==a||a.setColumn(e)},getSelections:async()=>{const e=await v();return(null==e?void 0:e.selections)||[]},setSearchParams:e=>{g.currentPage=1,g.params=Object.assign(g.params,{pageSize:g.pageSize,pageIndex:g.currentPage,...e}),f.getList()},delList:async(e,a,s=!0)=>{const o=await v();if(a){if(!(null==o?void 0:o.selections.length))return void n.warning(u("common.delNoData"))}else if(!g.currentRow)return void n.warning(u("common.delNoData"));s?t.confirm(u("common.delMessage"),u("common.delWarning"),{confirmButtonText:u("common.delOk"),cancelButtonText:u("common.delCancel"),type:"warning"}).then((async()=>{await P(e)})):await P(e)}};return(null==a?void 0:a.props)&&f.setProps(a.props),{register:(e,a)=>{p.value=e,d.value=l(a)},elTableRef:d,tableObject:g,methods:f}};export{g as u};
